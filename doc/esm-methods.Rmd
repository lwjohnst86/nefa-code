---
output: fost::diabetologia_manuscript
---

```{r setup, include=FALSE}
devtools::load_all()
set_options()
knitr::opts_chunk$set(results = "asis")
```

# ESM Methods

## Equations for outcomes

The equations for calculating the outcome variables are listed below. HOMA2-%S was 
calculated using the Excel found at https://www.dtu.ox.ac.uk/homacalculator/.

```{r}
PROMISE.methods::insert_formula("ISI")
```

```{r}
PROMISE.methods::insert_formula("HOMA")
```

```{r}
PROMISE.methods::insert_formula("IGIIR")
```

```{r}
PROMISE.methods::insert_formula("ISSI2")
```

Area under the curve (AUC) for both glucose (G) and insulin (I) was computed
using the trapezoidal rule. ISI~OGTT~ (ISI) uses all the glucose and insulin
values from the oral glucose tolerance (the overall mean).

## Further description of statistical methods

Generalized estimating equations (GEE) is a technique similar to mixed effects 
modeling, except it calculates the marginal population estimates compared to the
subject-specific estimates in mixed effects models. GEE is well suited to and
commonly used in longitudinal cohort studies, especially given its capacity to
handle missed visits. GEE is able to handle longitudinal data due to the
estimating of a working correlation matrix, which was chosen based on
quasi-likelihood information criteria (QIC). The auto-regressive of order 1
(AR1) matrix was chosen for the GEE models as it had the best model fit accessed
using QIC, though other matrices (eg. exchangeable) had similar fit (data not
shown).

For the confounders, they were chosen based on previous literature, from 
directed acyclic graph (DAG) recommendations, and from QIC. The DAG
recommendations were obtained from using the DAGitty software,
http://dagitty.net/. The final GEE model selected as best fitting was negligibly
different when using insulin sensitivity or beta-cell function as an outcome and
as such the same covariates were chosen for models with each of the outcomes.

Partial least squares (PLS) regression is a technique similar to principal
component analysis (PCA) that is designed to extract meaningful information from
multivariate, high dimensionality data (e.g. as in metabolomic and other -omic type 
analyses). These types of methods try to extract as much of the variance in the 
data into a smaller number of components or factors. The difference between PCA 
and PLS is that PLS is a supervised method, while PCA is not. This means that
PLS uses a response variable(s), i.e. an outcome or **Y**, to 'supervise' (or
constrain) the variation inherent in the predictors (**X**) while PCA only
describes the variation inherent in **X**. Because of this, PLS can be better at
predicting the contributions of predictor variables against an outcome variable.
